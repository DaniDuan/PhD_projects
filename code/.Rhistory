r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
#for i in unique(w02_M$variable){
i = unique(w02_M$variable)[1]
sub = subset(w02_M, variable == i)
plot(sub$Time, sub$value)
r_get = lm(log(value)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$value[sub$Time == 39])-log(sub$value[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$value))
K_start = sub$value[sub$Time == 39]
fit = nlsLM(value ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
#}
t = seq(0,60,1)
plot(W02$Time, W02$Mean)
lines(t, growth(t, r_max, K, N_0))
forp = data.frame(t, forline, S = i)
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
forp
p = ggplot(w02_M, aes(Time,value,color = variable))+ geom_point()
for(i in unique(w02_M$variable)){
# i = unique(w02_M$variable)[1]
sub = subset(w02_M, variable == i)
plot(sub$Time, sub$value)
r_get = lm(log(value)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$value[sub$Time == 39])-log(sub$value[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$value))
K_start = sub$value[sub$Time == 39]
fit = nlsLM(value ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, col = S)) + labs(x= "Time", y = "Cell Count")
}
p
raw = read.csv('../data/Bacteria_growth.csv', header = F)
W02 = data.frame(Time = as.numeric(raw[2,2:9]), S1 = as.numeric(raw[3,2:9]), S2 = as.numeric(raw[4, 2:9]), S3 = as.numeric(raw[5,2:9]))
Mean = rowMeans(W02[,2:4],na.rm = T)
w02_M = melt(W02, id.vars = "Time")
ggplot(w02_M, aes(Time,value,color = variable))+ geom_point()
growth = function(t, r_max, K, N_0){
return(N_0 * K * exp(r_max * t)/(K + N_0 * (exp(r_max * t) - 1)))
}
t = seq(0,60,1)
p = ggplot(w02_M, aes(Time,value,color = variable))+ geom_point()
for(i in unique(w02_M$variable)){
# i = unique(w02_M$variable)[1]
sub = subset(w02_M, variable == i)
plot(sub$Time, sub$value)
r_get = lm(log(value)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$value[sub$Time == 39])-log(sub$value[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$value))
K_start = sub$value[sub$Time == 39]
fit = nlsLM(value ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, col = S)) + labs(x= "Time", y = "Cell Count")
}
p
colnames(w02_M) = c("Time", "Strain", "Cell_Count")
raw = read.csv('../data/Bacteria_growth.csv', header = F)
W02 = data.frame(Time = as.numeric(raw[2,2:9]), S1 = as.numeric(raw[3,2:9]), S2 = as.numeric(raw[4, 2:9]), S3 = as.numeric(raw[5,2:9]))
Mean = rowMeans(W02[,2:4],na.rm = T)
w02_M = melt(W02, id.vars = "Time")
colnames(w02_M) = c("Time", "Strain", "Cell_Count")
growth = function(t, r_max, K, N_0){
return(N_0 * K * exp(r_max * t)/(K + N_0 * (exp(r_max * t) - 1)))
}
t = seq(0,60,1)
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+ geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, col = S)) + labs(x= "Time", y = "Cell Count")
}
p
library(ggplot2)
library(minpack.lm)
raw = read.csv('../data/Bacteria_growth.csv', header = F)
W02 = data.frame(Time = as.numeric(raw[2,2:9]), S1 = as.numeric(raw[3,2:9]), S2 = as.numeric(raw[4, 2:9]), S3 = as.numeric(raw[5,2:9]))
Mean = rowMeans(W02[,2:4],na.rm = T)
w02_M = melt(W02, id.vars = "Time")
colnames(w02_M) = c("Time", "Strain", "Cell_Count")
growth = function(t, r_max, K, N_0){
return(N_0 * K * exp(r_max * t)/(K + N_0 * (exp(r_max * t) - 1)))
}
t = seq(0,60,1)
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+ geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, col = S)) + labs(x= "Time", y = "Cell Count/ml")
}
p
raw = read.csv('../data/Bacteria_growth.csv', header = F)
W02 = data.frame(Time = as.numeric(raw[2,2:9]), S1 = as.numeric(raw[3,2:9]), S2 = as.numeric(raw[4, 2:9]), S3 = as.numeric(raw[5,2:9]))
Mean = rowMeans(W02[,2:4],na.rm = T)
w02_M = melt(W02, id.vars = "Time")
colnames(w02_M) = c("Time", "Strain", "Cell_Count")
growth = function(t, r_max, K, N_0){
return(N_0 * K * exp(r_max * t)/(K + N_0 * (exp(r_max * t) - 1)))
}
t = seq(0,60,1)
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+ geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, col = S)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+ geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, col = S)) + labs(x= "Time (hr)", y = "Cell Count/ml")+
scale_color_brewer(palette = "Accent", guide="none")
}
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+ geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline)) + labs(x= "Time (hr)", y = "Cell Count/ml")+
scale_color_brewer(palette = "Accent", guide="none")
}
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Accent", guide="none") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain)) + geom_point()
p
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Accent", guide="none") + geom_point()
p
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2", guide="none") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, S = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2", guide="none") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, Strain = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, color = Strain)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain)) + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, Strain = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, color = Strain)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain)) + geom_point()
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2", guide="none") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, Strain = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, color = Strain)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, Strain = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, color = Strain)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
pdf("../results/W02_growth.pdf")
pdf(file = "../results/W02_growth.pdf")
dev.off
dev.off()
pdf(file = "../results/W02_growth.pdf")
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, Strain = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, color = Strain)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
dev.off()
pdf(file = "../results/W02_growth.pdf", width = 4, height = 4)
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, Strain = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, color = Strain)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
dev.off()
pdf(file = "../results/W02_growth.pdf")
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, Strain = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, color = Strain)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
dev.off()
W02 = data.frame(Time = as.numeric(raw[2,2:9]), S1 = as.numeric(raw[3,2:9])*50, S2 = as.numeric(raw[4, 2:9])*50, S3 = as.numeric(raw[5,2:9])*50)
library(ggplot2)
library(minpack.lm)
raw = read.csv('../data/Bacteria_growth.csv', header = F)
W02 = data.frame(Time = as.numeric(raw[2,2:9]), S1 = as.numeric(raw[3,2:9])*50, S2 = as.numeric(raw[4, 2:9])*50, S3 = as.numeric(raw[5,2:9])*50)
Mean = rowMeans(W02[,2:4],na.rm = T)
w02_M = melt(W02, id.vars = "Time")
colnames(w02_M) = c("Time", "Strain", "Cell_Count")
growth = function(t, r_max, K, N_0){
return(N_0 * K * exp(r_max * t)/(K + N_0 * (exp(r_max * t) - 1)))
}
t = seq(0,60,1)
pdf(file = "../results/W02_growth.pdf")
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2") + geom_point()
for(i in unique(w02_M$Strain)){
# i = unique(w02_M$Strain)[1]
sub = subset(w02_M, Strain == i)
#  plot(sub$Time, sub$Cell_Count)
r_get = lm(log(Cell_Count)~Time, sub[sub$Time >= 19 & sub$Time <= 39,])
r_max_start = summary(r_get)$coefficients[2]
#r_max_start = (log(sub$Cell_Count[sub$Time == 39])-log(sub$Cell_Count[sub$Time == 19]))/20
N_0_start = min(na.omit(sub$Cell_Count))
K_start = sub$Cell_Count[sub$Time == 39]
fit = nlsLM(Cell_Count ~ growth(t = Time, r_max, K, N_0), sub,
list(r_max=r_max_start, N_0 = N_0_start, K = K_start), control = list(maxiter = 500))
r_max = coef(fit)["r_max"]
N_0 = coef(fit)["N_0"]
K = coef(fit)["K"]
forline = growth(t, r_max, K, N_0)
forp = data.frame(t, forline, Strain = i)
#  plot(W02$Time, W02$Mean)
#  lines(t, growth(t, r_max, K, N_0))
p = p+geom_line(data=forp, aes(x = t, y = forline, color = Strain)) + labs(x= "Time (hr)", y = "Cell Count/ml")
}
p
dev.off()
read.csv("../data/Silwood Ambient Temp Data Jan to May 2019.xlsx")
Temp_data = read.csv("../data/Silwood Ambient Temp Data Jan to May 2019.xlsx", header = F)
Temp_data = read.table("../data/Silwood Ambient Temp Data Jan to May 2019.xlsx", header = F)
Temp_data = read.table("../data/Silwood Ambient Temp Data Jan to May 2019.xlsx", sep = "\t",header = F)
Temp_data = read.table("../data/Silwood Ambient Temp Data Jan to May 2019.xlsx", sep = "\t")
rm = list(ls)
rm(list= ls())
raw = read.csv('../data/Bacteria_growth.csv', header = F)
S18 = data.frame(Time = as.numeric(raw[9,2:6]), S1 = as.numeric(raw[10,2:6])*50, S2 = as.numeric(raw[11, 2:6])*50, S3 = as.numeric(raw[12,2:6])*50)
View(S18)
Mean = rowMeans(S18[,2:4],na.rm = T)
Mean
s18_M = melt(S18, id.vars = "Time")
s18_M = melt(S18, id.vars = "Time")
library(ggplot2)
library(minpack.lm)
s18_M = melt(S18, id.vars = "Time")
library(reshape2)
s18_M = melt(S18, id.vars = "Time")
colnames(s18_M) = c("Time", "Strain", "Cell_Count")
View(s18_M)
S18 = cbind(S18, Mean)
plot(S18$Time, S18$Mean)
S18 = data.frame(Time = as.numeric(raw[9,2:6]), S1 = as.numeric(raw[10,2:6])*50, S2 = as.numeric(raw[11, 2:6])*50, S3 = as.numeric(raw[12,2:6])*50)
Mean = rowMeans(S18[,2:4],na.rm = T)
s18_M = melt(S18, id.vars = "Time")
colnames(s18_M) = c("Time", "Strain", "Cell_Count")
p = ggplot(w02_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2") + geom_point()
p = ggplot(s18_M, aes(Time,Cell_Count,color = Strain))+
scale_color_brewer(palette = "Dark2") + geom_point()
p
ggplot(s18_M, aes(Time,Cell_Count,color = Strain))+scale_color_brewer(palette = "Dark2") + geom_point()
pdf(file = "../results/S18_growth.pdf")
ggplot(s18_M, aes(Time,Cell_Count,color = Strain))+scale_color_brewer(palette = "Dark2") + geom_point()
dev.off()
