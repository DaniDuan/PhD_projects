ra_mean$temp = rep(temp,11)
sp_ra = c(sp[sort(rep(4:7,2))],sp[7])
spinside = c("S18", "W02", "S18", "W03", "W02", "W03", "S18", "W02", "W03")
colors_ra = c("darkgreen", "blue", "darkgreen", "chocolate2", "blue", "chocolate2", "darkgreen", "blue", "chocolate2")
pdf("../results/Ramping_relative_abundances.pdf")
for(i in 1:length(temp)){
for(j in 1:length(unique(sp_ra))){
sp_ra_v = which(sp_ra == unique(sp_ra)[j])
plot(1, type="n", xlab="Day", ylab = "%",
main = paste(unique(sp_ra)[j],"_", temp[i],sep=""), xlim = c(ra_time[1],ra_time[11]),
ylim =c(min(ra_mean[(11*(i-1)+1):(11*i),sp_ra_v], na.rm = T),
max(ra_mean[(11*(i-1)+1):(11*i),sp_ra_v], na.rm = T)))
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[1]], col = colors_ra[sp_ra_v][1], type="b", pch = 1)
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[2]], col = colors_ra[sp_ra_v][2], type="b", pch = 1)
if(length(sp_ra_v) == 3){
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[3]], col = colors_ra[sp_ra_v][3], type="b", pch = 1)
}
legend("right", spinside[sp_ra_v], cex = 1, col = colors_ra[sp_ra_v], pch = 1,
box.lty = 3, lwd = 1)
}
}
graphics.off()
for(i in 1:length(temp)){
for(j in 1:length(unique(sp_ra))){
sp_ra_v = which(sp_ra == unique(sp_ra)[j])
plot(1, type="n", xlab="Day", ylab = "%",
main = paste(unique(sp_ra)[j],"_", temp[i],sep=""), xlim = c(ra_time[1],ra_time[11]),
ylim =c(min(ra_mean[(11*(i-1)+1):(11*i),sp_ra_v], na.rm = T),
max(ra_mean[(11*(i-1)+1):(11*i),sp_ra_v], na.rm = T)))
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[1]], col = colors_ra[sp_ra_v][1], type="b", pch = 1)
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[2]], col = colors_ra[sp_ra_v][2], type="b", pch = 1)
if(length(sp_ra_v) == 3){
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[3]], col = colors_ra[sp_ra_v][3], type="b", pch = 1)
}
legend("right", spinside[sp_ra_v], cex = 1, col = colors_ra[sp_ra_v], pch = 1,
box.lty = 3, lwd = 1)
}
}
View(ra_mean[temp == "30C"])
View(ra_mean[seq(4,175,5)])
View(ra_mean[seq(4,175,5),])
seq(4,175,5)
View(ra_mean[seq(4,55,5),])
ra
View(ra[temp == 30])
View(ra[temp == "30"])
View(ra)
(11*(i-1)+1):(11*i)
i = 1
i = 4
(11*(i-1)+1):(11*i)
i = 1
sub = rbind(ra_p[1:6,],subset(ra_p, temp == t[i+1]))
View(sub)
View(ra_p)
####################### Relative abundance ###########################
ra = read.csv("../data/Ramping/Relative_abundance.csv")
ra_p = data.frame(matrix(NA, nrow = nrow(ra), ncol = 0))
for(i in 1:3){
ra_p = cbind(ra_p, ra[i*2-1]/(ra[i*2-1]+ra[i*2]), ra[i*2]/(ra[i*2-1]+ra[i*2]))
}
ra_p = cbind(ra_p, ra[7:9]/apply(ra[7:9],1,sum), ra[10:12])
d = unique(ra_p$Day)
t = unique(ra_p$temp)
ra_mean = data.frame()
for(i in 1:(length(t)-1)){
sub = rbind(ra_p[1:6,],subset(ra_p, temp == t[i+1]))
for(j in 1:length(d)){
mean = colMeans(sub[sub$Day==d[j],1:9], na.rm = T)
ra_mean = rbind(ra_mean, mean)
}
}
names(ra_mean) = colnames(ra_p)[1:9]
# sd_int = c(apply(ra[1:3,1:6], 2,sd), apply(ra[1:3, 7:9],2,sd))
ra_time = seq(0,24,2)[-12][-2]
ra_mean$day = sort(rep(ra_time, 5))
ra_mean$temp = rep(temp,11)
sp_ra = c(sp[sort(rep(4:7,2))],sp[7])
spinside = c("S18", "W02", "S18", "W03", "W02", "W03", "S18", "W02", "W03")
colors_ra = c("darkgreen", "blue", "darkgreen", "chocolate2", "blue", "chocolate2", "darkgreen", "blue", "chocolate2")
length(d)
d[j]
sub[sub$Day==d[j],1:9]
colMeans(sub[sub$Day==d[j],1:9], na.rm = T)
j
d[j]
j = 2
sub[sub$Day==d[j],1:9]
ra_mean = data.frame()
for(i in 1:(length(t)-1)){
sub = rbind(ra_p[1:6,],subset(ra_p, temp == t[i+1]))
for(j in 1:length(d)){
mean = colMeans(sub[sub$Day==d[j],1:9], na.rm = T)
ra_mean = rbind(ra_mean, mean)
}
}
names(ra_mean) = colnames(ra_p)[1:9]
# sd_int = c(apply(ra[1:3,1:6], 2,sd), apply(ra[1:3, 7:9],2,sd))
ra_time = seq(0,24,2)[-12][-2]
ra_mean$day = sort(rep(ra_time, 5))
ra_mean$temp = rep(temp,11)
View(ra)
1:(length(t)-1)
i = 4
sub = rbind(ra_p[1:6,],subset(ra_p, temp == t[i+1]))
for(j in 1:length(d)){
mean = colMeans(sub[sub$Day==d[j],1:9], na.rm = T)
ra_mean = rbind(ra_mean, mean)
}
ra_mean = data.frame()
for(j in 1:length(d)){
mean = colMeans(sub[sub$Day==d[j],1:9], na.rm = T)
ra_mean = rbind(ra_mean, mean)
}
ra_mean = data.frame()
sub[sub$Day==d[j],1:9]
mean
for(j in 1:length(d)){
mean = colMeans(sub[sub$Day==d[j],1:9], na.rm = T)
print(d[j])
ra_mean = rbind(ra_mean, mean)
}
rep(temp,11)
rep(ra_time, 5)
ra_mean = data.frame()
for(i in 1:(length(t)-1)){
sub = rbind(ra_p[1:6,],subset(ra_p, temp == t[i+1]))
for(j in 1:length(d)){
mean = colMeans(sub[sub$Day==d[j],1:9], na.rm = T)
print(d[j])
ra_mean = rbind(ra_mean, mean)
}
}
names(ra_mean) = colnames(ra_p)[1:9]
# sd_int = c(apply(ra[1:3,1:6], 2,sd), apply(ra[1:3, 7:9],2,sd))
ra_time = seq(0,24,2)[-12][-2]
ra_mean$day = sort(rep(ra_time, 5))
ra_mean$temp = rep(temp,11)
rep(temp,11)
rep(ra_time, 5)
rep(ra_time, 5)
ra_mean$day = rep(ra_time, 5)
temp
rep(1:5,11)
sort(rep(1:5,11))
temp[sort(rep(1:5,11))]
ra_mean$temp = temp[sort(rep(1:5,11))]
sp_ra = c(sp[sort(rep(4:7,2))],sp[7])
spinside = c("S18", "W02", "S18", "W03", "W02", "W03", "S18", "W02", "W03")
colors_ra = c("darkgreen", "blue", "darkgreen", "chocolate2", "blue", "chocolate2", "darkgreen", "blue", "chocolate2")
for(i in 1:length(temp)){
for(j in 1:length(unique(sp_ra))){
sp_ra_v = which(sp_ra == unique(sp_ra)[j])
plot(1, type="n", xlab="Day", ylab = "%",
main = paste(unique(sp_ra)[j],"_", temp[i],sep=""), xlim = c(ra_time[1],ra_time[11]),
ylim =c(min(ra_mean[(11*(i-1)+1):(11*i),sp_ra_v], na.rm = T),
max(ra_mean[(11*(i-1)+1):(11*i),sp_ra_v], na.rm = T)))
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[1]], col = colors_ra[sp_ra_v][1], type="b", pch = 1)
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[2]], col = colors_ra[sp_ra_v][2], type="b", pch = 1)
if(length(sp_ra_v) == 3){
lines(ra_time,ra_mean[(11*(i-1)+1):(11*i),sp_ra_v[3]], col = colors_ra[sp_ra_v][3], type="b", pch = 1)
}
legend("right", spinside[sp_ra_v], cex = 1, col = colors_ra[sp_ra_v], pch = 1,
box.lty = 3, lwd = 1)
}
}
##################### relative abundance with growth OD #################
# Initial
ra_data = data[,4:10]
ra_data_sd = sd[,4:9]
ra_data = data.frame(replicate(2, ra_data[,1],simplify = F),
replicate(2, ra_data[,2],simplify = F),
replicate(2, ra_data[,3],simplify = F),
replicate(3, ra_data[,4],simplify = F),data[,8:10])
ra_data_sd = data.frame(replicate(2, ra_data_sd[,1],simplify = F),
replicate(2, ra_data_sd[,2],simplify = F),
replicate(2, ra_data_sd[,3],simplify = F),
replicate(3, ra_data_sd[,4],simplify = F),data[,8:10])
ra_OD = data.frame()
ra_OD_sd = data.frame()
for(i in 1:length(unique(ra_mean$day))){
ra_sub = subset(ra_mean, ra_mean$day == unique(ra_mean$day)[i])
if(i<10){
sub = subset(ra_data, ra_data$sp_group == (3*(i -1)+1)|ra_data$sp_group == (3*i-1)|ra_data$sp_group == (3*i))
sub_sd = subset(ra_data_sd, ra_data_sd$sp_group == (3*(i -1)+1)|ra_data_sd$sp_group == (3*i-1)|ra_data_sd$sp_group == (3*i))
rep_sub = do.call("rbind",replicate(3, ra_sub,simplify = F))
}
else{
sub = subset(ra_data, ra_data$sp_group == (4*(i -3))|ra_data$sp_group == (4*(i -3)+1)|ra_data$sp_group == (4*(i -3)+2)|ra_data$sp_group == (4*(i -3)+3))
sub_sd = subset(ra_data_sd, ra_data_sd$sp_group ==  (4*(i -3))|ra_data_sd$sp_group == (4*(i -3)+1)|ra_data_sd$sp_group == (4*(i -3)+2)|ra_data_sd$sp_group == (4*(i -3)+3))
rep_sub = do.call("rbind",replicate(4, ra_sub,simplify = F))
}
ra_OD = rbind(ra_OD, sub[,1:9]*rep_sub[1:9])
ra_OD_sd = rbind(ra_OD_sd, sub_sd[,1:9]*rep_sub[1:9])
}
names(ra_OD) = names(ra_mean[,1:9])
names(ra_OD_sd) = names(ra_mean[,1:9])
ra_OD = cbind(ra_OD, data[,8:10])
ra_OD_sd = cbind(ra_OD_sd, data[,8:10])
for(i in 1:length(temp)){
for(j in 1:length(unique(sp_ra))){
sp_ra_v = which(sp_ra == unique(sp_ra)[j])
sub = ra_OD[seq(i,175,5),sp_ra_v]
plot(1, type="n", xlab="Day", ylab = "%",
main = paste(unique(sp_ra)[j],"_", temp[i],sep=""),
xlim = c(time[1],time[length(time)]),
ylim =c(min(sub, na.rm = T), max(sub, na.rm = T)))
lines(time,sub[,1], col = colors_ra[sp_ra_v][1], type="b", pch = 1)
lines(time,sub[,2], col = colors_ra[sp_ra_v][2], type="b", pch = 1)
if(length(sp_ra_v) == 3){
lines(time,sub[,3], col = colors_ra[sp_ra_v][3], type="b", pch = 1)
}
legend("topright", spinside[sp_ra_v], cex = 1, col = colors_ra[sp_ra_v], pch = 1,
box.lty = 3, lwd = 1)
}
}
graphics.off()
for(i in 1:length(temp)){
for(j in 1:length(unique(sp_ra))){
sp_ra_v = which(sp_ra == unique(sp_ra)[j])
sub = ra_OD[seq(i,175,5),sp_ra_v]
plot(1, type="n", xlab="Day", ylab = "OD",
main = paste(unique(sp_ra)[j],"_", temp[i],sep=""),
xlim = c(time[1],time[length(time)]),
ylim =c(min(sub, na.rm = T), max(sub, na.rm = T)))
lines(time,sub[,1], col = colors_ra[sp_ra_v][1], type="b", pch = 1)
lines(time,sub[,2], col = colors_ra[sp_ra_v][2], type="b", pch = 1)
if(length(sp_ra_v) == 3){
lines(time,sub[,3], col = colors_ra[sp_ra_v][3], type="b", pch = 1)
}
legend("topright", spinside[sp_ra_v], cex = 1, col = colors_ra[sp_ra_v], pch = 1,
box.lty = 3, lwd = 1)
}
}
pdf("../results/ra_OD_bytemp.pdf")
for(i in 1:length(temp)){
for(j in 1:length(unique(sp_ra))){
sp_ra_v = which(sp_ra == unique(sp_ra)[j])
sub = ra_OD[seq(i,175,5),sp_ra_v]
plot(1, type="n", xlab="Day", ylab = "OD",
main = paste(unique(sp_ra)[j],"_", temp[i],sep=""),
xlim = c(time[1],time[length(time)]),
ylim =c(min(sub, na.rm = T), max(sub, na.rm = T)))
lines(time,sub[,1], col = colors_ra[sp_ra_v][1], type="b", pch = 1)
lines(time,sub[,2], col = colors_ra[sp_ra_v][2], type="b", pch = 1)
if(length(sp_ra_v) == 3){
lines(time,sub[,3], col = colors_ra[sp_ra_v][3], type="b", pch = 1)
}
legend("topright", spinside[sp_ra_v], cex = 1, col = colors_ra[sp_ra_v], pch = 1,
box.lty = 3, lwd = 1)
}
}
graphics.off()
pdf("../results/ra_OD.pdf")
for(i in 1:length(temp)){
for(j in 1:length(unique(sp_ra))){
sp_ra_v = which(sp_ra == unique(sp_ra)[j])
sub = ra_OD[seq(i,175,5),sp_ra_v]
plot(1, type="n", xlab="Day", ylab = "OD",
main = paste(unique(sp_ra)[j],"_", temp[i],sep=""),
xlim = c(time[1],time[length(time)]),
ylim =c(min(sub, na.rm = T), max(sub, na.rm = T)))
lines(time,sub[,1], col = colors_ra[sp_ra_v][1], type="b", pch = 1)
lines(time,sub[,2], col = colors_ra[sp_ra_v][2], type="b", pch = 1)
if(length(sp_ra_v) == 3){
lines(time,sub[,3], col = colors_ra[sp_ra_v][3], type="b", pch = 1)
}
legend("topright", spinside[sp_ra_v], cex = 1, col = colors_ra[sp_ra_v], pch = 1,
box.lty = 3, lwd = 1)
}
}
graphics.off()
pdf("../results/ramping_ra_OD.pdf")
graphics.off()
pdf("../results/Ramping_ra_OD.pdf")
for(i in 1:length(temp)){
for(j in 1:length(unique(sp_ra))){
sp_ra_v = which(sp_ra == unique(sp_ra)[j])
sub = ra_OD[seq(i,175,5),sp_ra_v]
plot(1, type="n", xlab="Day", ylab = "OD",
main = paste(unique(sp_ra)[j],"_", temp[i],sep=""),
xlim = c(time[1],time[length(time)]),
ylim =c(min(sub, na.rm = T), max(sub, na.rm = T)))
lines(time,sub[,1], col = colors_ra[sp_ra_v][1], type="b", pch = 1)
lines(time,sub[,2], col = colors_ra[sp_ra_v][2], type="b", pch = 1)
if(length(sp_ra_v) == 3){
lines(time,sub[,3], col = colors_ra[sp_ra_v][3], type="b", pch = 1)
}
legend("topright", spinside[sp_ra_v], cex = 1, col = colors_ra[sp_ra_v], pch = 1,
box.lty = 3, lwd = 1)
}
}
graphics.off()
pdf("../results/Ramping_OD_bytemp_onlyRJ.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 2 | j == 5){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c("10C","10_30C", "20C", "30C", "Ramping"), cex = 1,
col = color, pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
pdf("../results/Ramping_OD_bytemp_onlyR30.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 4 | j == 5){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c("10C","10_30C", "20C", "30C", "Ramping"), cex = 1,
col = color, pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
pdf("../results/Ramping_OD_bytemp_RJ20.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 2 | j == 3| j == 5){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c("10C","10_30C", "20C", "30C", "Ramping"), cex = 1,
col = color, pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
pdf("../results/Ramping_OD_bytemp_1030J.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 1 | j == 2| j == 4){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c("10C","10_30C", "20C", "30C", "Ramping"), cex = 1,
col = color, pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
temp
pdf("../results/Ramping_OD_bytemp_1030J.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 1 | j == 2| j == 4){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", temp[1,2,4], cex = 1, col = color[1,2,4], pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
temp[1,2,4]
temp[1&2&4]
temp[1&&2&&4]
pdf("../results/Ramping_OD_bytemp_1030J.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 1 | j == 2| j == 4){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c(temp[1],temp[2],temp[4]), cex = 1, col = c(color[1], color[2],color[4]), pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
a
a
a
pdf("../results/Ramping_OD_bytemp_JR.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 2| j == 5){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c(temp[2],temp[5]), cex = 1, col = c(color[2],color[5]), pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
pdf("../results/Ramping_OD_bytemp_20R.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 3| j == 5){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c(temp[3],temp[5]), cex = 1, col = c(color[3],color[5]), pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
x = c(1,3,4,5)
pdf("../results/Ramping_OD_bytemp_102030R.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j !=2 ){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c(temp[x]), cex = 1, col = c(color[x]), pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 1| j == 3| j == 5){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c(temp[1],temp[3],temp[5]), cex = 1, col = c(color[1],color[3],color[5]), pch = 1, lwd = 1)
# graphics.off()
}
pdf("../results/Ramping_OD_bytemp_20J.pdf")
for(i in 1:7){ # Species
# png(filename = paste(("../results/Ramping_OD_bytemp/OD_temp_"),sp[i],".png", sep=""), width = 480, height = 480)
plot(1, type="n", xlab="Day", ylab = "OD",
main = sp[i], xlim = c(time[1],time[length(time)]),
ylim =c(min(data[1:175,(8-i)]-sd[1:175,(8-i)]),max(data[1:175,(8-i)]+sd[1:175,(8-i)])))
for(j in 1:5){ # temperature treatment
if(j == 3| j == 2){
lines(time, data[seq(j,175,5),(8-i)], col = color[j], type="b", pch = 1)
arrows(x0=time, y0=data[seq(j,175,5),(8-i)]-sd[seq(j,175,5),(8-i)],
x1=time, y1=data[seq(j,175,5),(8-i)]+sd[seq(j,175,5),(8-i)],
code=3, angle=90, lwd=1, length = 0.05, col = color[j])
}
}
abline(v = 13, lty = 3)
legend("topleft", c(temp[3],temp[2]), cex = 1, col = c(color[3],color[2]), pch = 1, lwd = 1)
# graphics.off()
}
graphics.off()
